<!DOCTYPE html>



<html>
<head>
  <title>Documentation for gololang.Async</title>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    body {
      font-family: Helvetica, Arial, sans-serif;
      color: #333;
      background-color: #fff;
      border-color: #999999;
      border-width: 2px;
      margin: 1em auto;
      margin-left: 20em;
      max-width: 50em;
      text-align: left;
      padding: 0.5em;
    }
    pre {
      background-color: #eee;
      -webkit-border-radius: 5px;
      -moz-border-radius: 5px;
      border-radius: 5px;
      overflow: auto;
    }
    code {
      font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
      font-size: 80%;
      background-color: #eee;
      padding: 1px 3px;
      -webkit-border-radius: 2px;
      -moz-border-radius: 2px;
      border-radius: 2px;
    }
    pre code {
      font-size: 120%;
      padding-left: 0px;
      padding-right: 0px;
    }

    .listing:hover code[data-lang]:before {
      display: block;
    }

    .listing code {
      position: relative;
    }

    .listing code[data-lang]:before {
      display: none;
      content: attr(data-lang);
      position: absolute;
      font-size: 0.75em;
      top: .5rem;
      right: 0.5rem;
      line-height: 1;
      text-transform: uppercase;
      color: #000;
    }

    li p {
      margin: 0.3em;
    }
    ul > li {
      list-style-type: disc;
    }
    a:link, a:visited {
      color: #33e;
      text-decoration: none;
    }
    a:hover {
      color: #00f;
      text-decoration:underline;
    }
    h1 {
      color: #999;
      font-weight: 400;
      font-size: 250%;
    }
    h2 {
      border-bottom: 1px dotted #aaa;
      margin-bottom: 1em;
      color: #333;
      font-size: 200%;
      font-style: normal;
      font-weight: bold;
    }
    h3 {
      color: #666;
      font-size: 180%;
      font-style: normal;
      font-weight: bold;
    }
    h4 {
      font-size: 130%;
      font-style: normal;
      font-weight: bold;
    }
    h5 {
      font-size: 100%;
      font-style: normal;
      font-weight: bold;
    }
    h6 {
      font-size: 100%;
      font-style: italic;
      font-weight: normal;
    }

    #toc {
      margin: 0;
      padding: 0;
      position: fixed;
      top: 0px;
      bottom: 0px;
      left: 0px;
      width: 20em;
      overflow: auto;
      white-space: nowrap;
    }

    #toc h1 {
      margin: .5em;
      padding: 1ex;
      font-size: 90%;
      font-weight: bold;
      font-style: normal;
      color: #333;
      background-color: #eee;
      text-align: center;
    }

    #toc ul {
      padding-left: 1em;
    }

    #toc > ul {
      font-size: 80%;
      margin: 0.5em;
    }

    #toc > ul > li {
      list-style: none;
      margin-bottom: 2ex;
    }

    #toc > ul > li > a {
      font-weight: bold;
      color: #333;
      display: block;
      padding: 1ex;
      margin: 0 1em 1ex 0;
      border-bottom: 1px solid #999;
    }

    #toc li {
      list-style-type: none;
    }

    :target {
      background-color: yellow;
    }

    .permalink {
      margin-left: .3em;
      font-size: 70%;
      visibility: hidden;
    }

    *:hover > .permalink {
      visibility: visible;
    }

    .golodoc {
      margin: 0;
      padding: 0;
      padding-left: 1.5em;
    }

    @media (max-width: 50em) {
      #toc {
        display: none;
      }

      body {
        margin: 0;
        padding: 0.5em;
      }

      h1 {
        font-size: 200%;
      }
    }

  </style>
</head>
<body>
<h1>Documentation for gololang.Async</h1>
<!-- begin table of content -->
<nav id="toc">
<h1>gololang.Async</h1>
<ul>

  
  <li><a href="#structs">Structs</a><ul>
    
    <li><a href="#FutureBridge">FutureBridge</a></li>
    
  </ul></li>
  

  



  

  
  <li><a href="#augmentations">Augmentations</a><ul>
    
    <li><a href="#augment.gololang.Async.types.FutureBridge">gololang.Async.types.FutureBridge</a><ul>
      
      <li><a href="#gololang.Async.types.FutureBridge.cancel_2">cancel(this, mayInterruptIfRunning)</a></li>
      
      <li><a href="#gololang.Async.types.FutureBridge.fallbackTo_2">fallbackTo(this, future)</a></li>
      
      <li><a href="#gololang.Async.types.FutureBridge.filter_2">filter(this, pred)</a></li>
      
      <li><a href="#gololang.Async.types.FutureBridge.flatMap_2">flatMap(this, fun)</a></li>
      
      <li><a href="#gololang.Async.types.FutureBridge.map_2">map(this, fun)</a></li>
      
      <li><a href="#gololang.Async.types.FutureBridge.onFail_2">onFail(this, listener)</a></li>
      
      <li><a href="#gololang.Async.types.FutureBridge.onSet_2">onSet(this, listener)</a></li>
      
    </ul></li>
    
    <li><a href="#augment.gololang.concurrent.async.Future">gololang.concurrent.async.Future</a><ul>
      
      <li><a href="#gololang.concurrent.async.Future.fallbackTo_2">fallbackTo(this, future)</a></li>
      
      <li><a href="#gololang.concurrent.async.Future.filter_2">filter(this, pred)</a></li>
      
      <li><a href="#gololang.concurrent.async.Future.flatMap_2">flatMap(this, fun)</a></li>
      
      <li><a href="#gololang.concurrent.async.Future.map_2">map(this, fun)</a></li>
      
    </ul></li>
    
    <li><a href="#augment.gololang.concurrent.async.Promise">gololang.concurrent.async.Promise</a><ul>
      
      <li><a href="#gololang.concurrent.async.Promise.initialize_2">initialize(this, closure)</a></li>
      
      <li><a href="#gololang.concurrent.async.Promise.initializeWithinThread_2">initializeWithinThread(this, closure)</a></li>
      
    </ul></li>
    
    <li><a href="#augment.java.util.concurrent.ExecutorService">java.util.concurrent.ExecutorService</a><ul>
      
      <li><a href="#java.util.concurrent.ExecutorService.enqueue_2">enqueue(this, fun)</a></li>
      
    </ul></li>
    
  </ul></li>
  

  
  <li><a href="#functions">Functions</a><ul>
    
    <li><a href="#all_1">all(futures)</a></li>
    
    <li><a href="#any_1">any(futures)</a></li>
    
    <li><a href="#failedFuture_1">failedFuture(throwable)</a></li>
    
    <li><a href="#promise_0">promise()</a></li>
    
    <li><a href="#reduce_3">reduce(futures, init, reducer)</a></li>
    
    <li><a href="#setFuture_1">setFuture(value)</a></li>
    
  </ul></li>
  
</ul>
</nav>
<!-- end table of content -->

<div class="golodoc">
  <p>This module offers asynchronous programming helpers, especially execution context agnostic promises
and futures. The provided APIs are orthogonal to the execution strategy: it is up to you to execute
code from the same thread, from a separate thread, or by pushing new tasks to a service executor.</p>
<p>The functions and augmentations in this module often delegate to Java classes from
<code>gololang.concurrent.async</code>.</p>

</div>


  <h2 id="structs">Structs</h2>
  
    <h3 id="FutureBridge">FutureBridge
    <a class="permalink" href="#FutureBridge" title="link to this section">&#182;</a></h3>

    <h5>Members</h5>
    <ul>
    
      <li><code>_goloFuture</code></li>
  
      <li><code>_javaFuture</code></li>
  
    </ul>
    <div class="golodoc">
      <p>Bridge structure to hold a reference to a Golo future and a Java future.</p>
<p>Instances of this struct are being returned by the
<a href="#java.util.concurrent.ExecutorService.enqueue_2"><code>enqueue</code></a> augmentation
on <code>ExecutorService</code> instances. This essentially adds the ability to:</p>
<ul>
<li>use the Golo future for its composability, and</li>
<li>use tha Java future to cancel a job.</li>
</ul>

    </div>
  








  <h2 id="augmentations">Augmentations</h2>
  
    <h3 id="augment.gololang.Async.types.FutureBridge">gololang.Async.types.FutureBridge
    <a class="permalink" href="#augment.gololang.Async.types.FutureBridge" title="link to this section">&#182;</a></h3>
    <div class="golodoc">
      <p>A set of forwarding augmentations for <a href="#FutureBridge"><code>FutureBridge</code></a> instances.</p>
<p>The provided functions all forward to Golo futures, while
<a href="#gololang.Async.types.FutureBridge.cancel_2"><code>cancel</code></a>
forwards to a Java future.</p>

    </div>
    
    
      
        <h4 id="gololang.Async.types.FutureBridge.cancel_2">cancel(this, mayInterruptIfRunning)
      
      <a class="permalink" href="#gololang.Async.types.FutureBridge.cancel_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        
      </div>
    
      
        <h4 id="gololang.Async.types.FutureBridge.fallbackTo_2">fallbackTo(this, future)
      
      <a class="permalink" href="#gololang.Async.types.FutureBridge.fallbackTo_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        
      </div>
    
      
        <h4 id="gololang.Async.types.FutureBridge.filter_2">filter(this, pred)
      
      <a class="permalink" href="#gololang.Async.types.FutureBridge.filter_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        
      </div>
    
      
        <h4 id="gololang.Async.types.FutureBridge.flatMap_2">flatMap(this, fun)
      
      <a class="permalink" href="#gololang.Async.types.FutureBridge.flatMap_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        
      </div>
    
      
        <h4 id="gololang.Async.types.FutureBridge.map_2">map(this, fun)
      
      <a class="permalink" href="#gololang.Async.types.FutureBridge.map_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        
      </div>
    
      
        <h4 id="gololang.Async.types.FutureBridge.onFail_2">onFail(this, listener)
      
      <a class="permalink" href="#gololang.Async.types.FutureBridge.onFail_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        
      </div>
    
      
        <h4 id="gololang.Async.types.FutureBridge.onSet_2">onSet(this, listener)
      
      <a class="permalink" href="#gololang.Async.types.FutureBridge.onSet_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        
      </div>
    
  
    <h3 id="augment.gololang.concurrent.async.Future">gololang.concurrent.async.Future
    <a class="permalink" href="#augment.gololang.concurrent.async.Future" title="link to this section">&#182;</a></h3>
    <div class="golodoc">
      <p>Augmentation on the base <code>Future</code> objects provided by the <code>gololang.concurrent.async.Future</code> Java
class.</p>

    </div>
    
    
      
        <h4 id="gololang.concurrent.async.Future.fallbackTo_2">fallbackTo(this, future)
      
      <a class="permalink" href="#gololang.concurrent.async.Future.fallbackTo_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        <p>Returns a fallback future:</p>
<ul>
<li>when this future is set, the returned future is set to the same value,</li>
<li>when it fails, the returned future matches the success or failure of <code>future</code>.</li>
</ul>

      </div>
    
      
        <h4 id="gololang.concurrent.async.Future.filter_2">filter(this, pred)
      
      <a class="permalink" href="#gololang.concurrent.async.Future.filter_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        <p>Returns a future that filters this future through the <code>pred</code> predicate function.</p>
<p>Suppose that this future is set to <code>v</code>:</p>
<ul>
<li>if <code>pred(v)</code> is <code>true</code>, then the result future is set to <code>v</code>,</li>
<li>if <code>pred(v)</code> is <code>false</code>, then the result is failed to a <code>java.util.NoSuchElementException</code>.</li>
</ul>
<p>If this future fails, so does the returned future.</p>

      </div>
    
      
        <h4 id="gololang.concurrent.async.Future.flatMap_2">flatMap(this, fun)
      
      <a class="permalink" href="#gololang.concurrent.async.Future.flatMap_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        <p>Similar to <a href="#gololang.concurrent.async.Future.map_2"><code>map</code></a>,
except that <code>fun</code> returns a future, not a value.</p>

      </div>
    
      
        <h4 id="gololang.concurrent.async.Future.map_2">map(this, fun)
      
      <a class="permalink" href="#gololang.concurrent.async.Future.map_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        <p>Returns a future whose value is mapped through the <code>fun</code> function.</p>
<p>If this future is set to <code>v</code>, then the returned future is set to <code>fun(v)</code>. If it fails, the
returned future is also failed with the same exception.</p>

      </div>
    
  
    <h3 id="augment.gololang.concurrent.async.Promise">gololang.concurrent.async.Promise
    <a class="permalink" href="#augment.gololang.concurrent.async.Promise" title="link to this section">&#182;</a></h3>
    <div class="golodoc">
      <p>Augmentation on the base <code>Promise</code> objects provided by the <code>gololang.concurrent.async.Promise</code> Java
class.</p>
<p>The promise initialize method takes one argument, a callback with two parameters, resolve and reject.
Do something within the callback, then call resolve if everything worked, otherwise call reject:</p>
<pre class="listing highlight highlightjs"><code class="language-golo" data-lang="golo">let myPromise = -&gt; promise(): initialize(|resolve, reject| {
  if everythingTurnedOutFine is true {
    resolve("Stuff worked!")
  } else {
    reject(java.lang.Exception("Failed!"))
  }
})

myPromise()
  : onSet(|result| {
      println(result) # Stuff worked!
  })
  : onFail(|err| {
      println(err: getMessage()) # Failed!
  })
</code></pre>

    </div>
    
    
      
        <h4 id="gololang.concurrent.async.Promise.initialize_2">initialize(this, closure)
      
      <a class="permalink" href="#gololang.concurrent.async.Promise.initialize_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        
      </div>
    
      
        <h4 id="gololang.concurrent.async.Promise.initializeWithinThread_2">initializeWithinThread(this, closure)
      
      <a class="permalink" href="#gololang.concurrent.async.Promise.initializeWithinThread_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        <p>You can define a promise which runs &ldquo;stuff&rdquo; inside a Thread</p>

      </div>
    
  
    <h3 id="augment.java.util.concurrent.ExecutorService">java.util.concurrent.ExecutorService
    <a class="permalink" href="#augment.java.util.concurrent.ExecutorService" title="link to this section">&#182;</a></h3>
    <div class="golodoc">
      <p>Augmentations for <code>ExecutorService</code>.</p>

    </div>
    
    
      
        <h4 id="java.util.concurrent.ExecutorService.enqueue_2">enqueue(this, fun)
      
      <a class="permalink" href="#java.util.concurrent.ExecutorService.enqueue_2" title="link to this section">&#182;</a></h4>
      <div class="golodoc">
        <p>Submits a function <code>fun</code> to be executed by this scheduler, and returns a
<a href="#FutureBridge"><code>FutureBridge</code></a>.</p>
<p><code>fun</code> takes no parameters, and its return value is used as a future value.</p>
<p>The returned <a href="#FutureBridge"><code>FutureBridge</code></a>` behaves both as a composable
Golo future and as a Java future that can be cancelled.</p>
<p>Here is a sample usage:</p>
<pre class="listing highlight highlightjs"><code class="language-golo" data-lang="golo"># Enqueue some elaborated work
let f = executor: enqueue({
  Thread.sleep(1000_L)
  return 666
})

# Watch what could happen
f: onSet(|v| -&gt; println(v)):
   onFail(|e| -&gt; println(e: getMessage()))

# ...but make it fail unless the CPU was too slow
f: cancel(true)
</code></pre>

      </div>
    
  



  <h2 id="functions">Functions</h2>
  
    <h3 id="all_1">all(futures)
    <a class="permalink" href="#all_1" title="link to this section">&#182;</a></h3>
    <div class="golodoc">
      <p>Given a collection of futures, returns a future whose value is eventually a vector with the
results of these futures.</p>
<p>Given:</p>
<pre class="listing highlight highlightjs"><code class="language-golo" data-lang="golo">all([ setFuture(1), failedFuture(e) ])
</code></pre>
<p>this yields a future whose eventual value is:</p>
<pre class="listing highlight highlightjs"><code class="language-golo" data-lang="golo">vector[1, e]
</code></pre>
<p>Results are accumulated as futures get resolved. The last completed future triggers the calls to
<code>onSet</code>-registered listeners on the same thread.</p>

    </div>
  
    <h3 id="any_1">any(futures)
    <a class="permalink" href="#any_1" title="link to this section">&#182;</a></h3>
    <div class="golodoc">
      <p>Given a collection of futures, returns a future whose value is set to the first completing future.</p>
<p>If all futures fail, then the returned future fails to a <code>java.util.NoSuchElementException</code>.</p>

    </div>
  
    <h3 id="failedFuture_1">failedFuture(throwable)
    <a class="permalink" href="#failedFuture_1" title="link to this section">&#182;</a></h3>
    <div class="golodoc">
      <p>Returns a failed future to a <code>throwable</code> exception.</p>

    </div>
  
    <h3 id="promise_0">promise()
    <a class="permalink" href="#promise_0" title="link to this section">&#182;</a></h3>
    <div class="golodoc">
      <p>Returns a new promise. Promise objects have the following useful methods.</p>
<ul>
<li><code>set(value)</code>: sets the promise value. The value is ignored if the promise has already been set.</li>
<li><code>fail(exception)</code>: set the value to an exception.</li>
<li><code>get()</code>: returns the promise value. It returns a bogus <code>null</code> value if the promise is still
undefined.</li>
<li><code>blockingGet()</code>: waits until the promise is set or failed, and returns the value.</li>
<li><code>future()</code>: returns a new future object on a promise.</li>
<li><code>isResolved()</code> and <code>isFailed()</code> query the promise status.</li>
</ul>
<p>Future objects have the following methods.</p>
<ul>
<li><code>onSet(|v| {...})</code>: registers a callback when the value is set, or executes it right now if it
has already been set.</li>
<li><code>onFail(|e| {...})</code>: registers a callback when the corresponding promise fails with an exception.</li>
<li><code>isResolved()</code>, <code>isFailed()</code> <code>get()</code> and <code>blockingGet()</code> delegate to the promise implementation.</li>
</ul>

    </div>
  
    <h3 id="reduce_3">reduce(futures, init, reducer)
    <a class="permalink" href="#reduce_3" title="link to this section">&#182;</a></h3>
    <div class="golodoc">
      <p>Returns a future whose value is set to the <em>reduction</em> of a collection of futures.</p>
<ul>
<li><code>futures</code> is a collection of futures, and</li>
<li><code>init</code> is the initial value, and</li>
<li><code>reducer</code> is the reducing function of the form <code>|acc, next| {...}</code>.</li>
</ul>
<p>If any future fails, then the result future fails, too. Otherwise, the returned future is set to the
accumulation of the values. Listeners callbacks get executed on the thread of the completing future
which is either the last successful future or the first future to fail.</p>

    </div>
  
    <h3 id="setFuture_1">setFuture(value)
    <a class="permalink" href="#setFuture_1" title="link to this section">&#182;</a></h3>
    <div class="golodoc">
      <p>Returns a future set to <code>value</code>.</p>

    </div>
  


<link rel="stylesheet" href="http://golo-lang.org/documentation/next/styles/github.min.css"/>
<script src="http://golo-lang.org/documentation/next/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>

</body>
</html>
